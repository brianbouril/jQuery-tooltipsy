/*
* Tooltipsy jQuery UI Widget v1.0
*
* Copyright (c) 2012 Brian Bouril
*
* Dual licensed under the MIT and GPL licenses, located in
* MIT-LICENSE.txt and GPL-LICENSE.txt respectively.
*
* Sun April 29 2012 09:27:29 GMT-0500 (CDT)
*/


(function($){$.widget("M4.tooltip",{options:{container:'tooltips',attribute:'alt',boundry:window,actionIn:'mouseover',actionOut:'mouseout',delay:500},_create:function(){var _this=this,el=_this.element,ctxc=_this.options.container,active=false,timer;el.bind(_this.options.actionIn,function(e){if(active==false){active=true;timer=setTimeout(function(){_this._loadContent();_this._posctxc(e);},_this.options.delay);}
$('body').one('click',function(){_this._destroy();});}).bind(_this.options.actionOut,function(e){clearTimeout(timer);active=false;_this._destroy();});},_setOption:function(key,value){$.Widget.prototype._setOption.apply(this,arguments);this._super("_setOption",key,value);},_posctxc:function(e){var _this=this,el=_this.element,$ctxc=$('#'+_this.options.container),$bdry=$(_this.options.boundry),ctxcW=$ctxc.outerWidth(),ctxcH=$ctxc.outerHeight(),elH=el.outerHeight(),elW=el.outerWidth(),elL=el.offset().left,elT=el.offset().top,cY=e.clientY,cX=e.clientX,bdryW=$bdry.width(),bdryH=$bdry.height();if(_this.options.boundry===window){var bdryO={'top':$bdry.scrollTop(),'left':$bdry.scrollLeft()};}else{var bdryO=$bdry.offset();}
_this._posToElement($ctxc,ctxcW,ctxcH,elT,elL,elW,elH,bdryW,bdryO);},_posToElement:function($ctxc,ctxcW,ctxcH,elT,elL,elW,elH,bdryW,bdryO){var _this=this;$ctxc.removeClass('left center right up down');if(elL+elW+((ctxcW-elW)/2)>bdryW){$ctxc.css({'left':Math.round(elL-(ctxcW-elW)-(elW/2))}).addClass('right');}else if(elL-((ctxcW-elW)/2)<0){$ctxc.css({'left':Math.round(elL+(elW/2))}).addClass('left');}else{$ctxc.css({'left':Math.round(elL-((ctxcW-elW)/2))}).addClass('center');}
if(elT-ctxcH<bdryO.top){$ctxc.css({'top':Math.round(elT+elH)}).addClass('up');}else{$ctxc.css({'top':Math.round(elT-ctxcH)}).addClass('down');}},_loadContent:function(){var _this=this,el=_this.element,$ctxc=$('<div>',{id:_this.options.container,class:'tooltip'}).html(el.attr(_this.options.attribute)).appendTo('body');_this._trigger('beforeLoad');$ctxc.fadeIn(400);_this._trigger('afterLoad');},destroy:function(){$.Widget.prototype.destroy.call(this);},_destroy:function(){var _this=this,$ctxc=$('#'+_this.options.container);$ctxc.remove();}});}(jQuery));